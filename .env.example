# Environment Configuration for Knytt
# Copy this file to .env and fill in your values

# =====================================================
# ENVIRONMENT
# =====================================================
ENVIRONMENT=development  # development, staging, production
DEBUG=true

# =====================================================
# SUPABASE CONFIGURATION
# =====================================================
# Get these from your Supabase project settings
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_KEY=your-service-role-key-here

# Direct PostgreSQL connection (optional, for migrations)
DATABASE_URL=postgresql://postgres:password@db.your-project.supabase.co:5432/postgres

# =====================================================
# REDIS CONFIGURATION (Memorystore or local)
# =====================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_URL=redis://localhost:6379/0

# =====================================================
# CELERY CONFIGURATION
# =====================================================
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0
CELERY_TASK_ALWAYS_EAGER=false  # Set to true for testing

# =====================================================
# GCP CONFIGURATION
# =====================================================
GCP_PROJECT_ID=your-gcp-project-id
GCP_REGION=us-central1
GCS_BUCKET=your-gcp-project-id-knytt-ml-dev

# For local development with service account
# GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account-key.json

# =====================================================
# ML MODEL CONFIGURATION
# =====================================================
CLIP_MODEL=ViT-B/32
EMBEDDING_DIMENSION=512

# Need following to run on Apple Silicon (Macbook M series)
PYTORCH_ENABLE_MPS_FALLBACK=0
OMP_NUM_THREADS=1
MKL_NUM_THREADS=1
OPENBLAS_NUM_THREADS=1

FAISS_INDEX_TYPE=IVFFlat
FAISS_NLIST=100
FAISS_NPROBE=10

# =====================================================
# API CONFIGURATION
# =====================================================
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_TIMEOUT_KEEP_ALIVE=120

# CORS
CORS_ORIGINS=http://localhost:3000,http://localhost:3001
CORS_ALLOW_CREDENTIALS=true

# Rate limiting
RATE_LIMIT_PER_MINUTE=60

# =====================================================
# FRONTEND CONFIGURATION (Next.js)
# =====================================================
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
NEXT_PUBLIC_API_URL=http://localhost:8000

# =====================================================
# LOGGING
# =====================================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json or text

# =====================================================
# FEATURE FLAGS
# =====================================================
ENABLE_ANALYTICS=false
ENABLE_RECOMMENDATIONS=true
ENABLE_VECTOR_SEARCH=true
ENABLE_NSFW_FILTER=true

# =====================================================
# PERFORMANCE TUNING
# =====================================================
# Cache TTL (seconds)
CACHE_TTL_SEARCH=300
CACHE_TTL_PRODUCTS=3600
CACHE_TTL_USER_EMBEDDINGS=1800

# Batch sizes
EMBEDDING_BATCH_SIZE=32
INGESTION_CHUNK_SIZE=1000

# =====================================================
# MONITORING (Optional)
# =====================================================
# SENTRY_DSN=your-sentry-dsn
# SENTRY_ENVIRONMENT=development

# Google Cloud Monitoring
# ENABLE_CLOUD_MONITORING=false

# =====================================================
# SECURITY
# =====================================================
JWT_SECRET_KEY=your-secret-key-here-change-in-production
JWT_ALGORITHM=HS256
JWT_EXPIRATION_MINUTES=60

# Session
SESSION_SECRET=your-session-secret-here

# =====================================================
# CLOUDFLARE (for production)
# =====================================================
# CLOUDFLARE_ZONE_ID=your-zone-id
# CLOUDFLARE_API_TOKEN=your-api-token
